---
title: "Using the MacroGrowth package"
author: "Matthew Kuperus Heun"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction

The `MacroGrowth` package provides sophisticated tools for fitting macroeconomic 
growth models to data.
`MacroGrowth` has several desirable features for economic modelers:

* Functions that fit several different macroeconomic growth models.
* Functions fit along 
boundaries of the economically-meaningful region, 
thereby ensuring that the best possible fit is found.
* Options to perform residual resampling, 
thereby providing a way to assess the variability of estimated parameters.
* A consistent formula-based interface to fitting functions.

The functions in this package were developed for and used first in the paper
Heun, M.K., J. Santos, P.E. Brockway, R. Pruim, T. Domingos, and M. Sakai.
"From Theory to Econometrics to Energy Policy: 
Cautionary Tales for Policymaking Using Aggregate Production Functions".
*Energies*, pp. 1-44, 10 (203), 2017.
<http://doi.org/10.3390/en10020203>.

## Data

The starting point for any fitting process is macroeconomic data.
For this vignette, we'll use a subset of the UK macroeconomic data 
from the "Cautionary Tales" paper by Heun et al. <http://doi.org/10.3390/en10020203>.

```{r}
library(dplyr)
library(MacroGrowth)
head(EconUK)
```

The `EconUK` data frame contains 
GDP, capital, labor, and two types of energy data
(primary exergy and useful exergy). 
All time series indexed by ratio to an initial year (1960),
such that all quantities are 1 in 1960.

## Macroeconomic growth models

`MacroGrowth` supports the following macroeconomic growth models:

* Cobb-Douglas (CD): $y = \theta \: \mathrm{e}^{\lambda t} \: 
                          x_1^{\alpha_1} \, x_2^{\alpha_2} \, x_3^{\alpha_3}$
* Constant Elasticity of Substitution (CES):
          $y = \theta \: \mathrm{e}^{\lambda t} \, \left\{\delta \left[\delta_1 x_1^{-\rho_1}
                + (1-\delta_1)x_2^{-\rho_1} \right]^{\rho/\rho_1}
                + (1-\delta) x_3^{-\rho} \right\}^{-1/\rho}$, and 
* Linear Exponential (Linex): 
          $y = \theta \: x_3 \exp{\left\{ 2 a_0 \left[ 1 - \frac{x_2 + x_3}{2 x_1} \right] + 
                      a_1 \left[ \frac{x_2}{x_3} - 1 \right] \right\}}$.

In the above equations:

* $y$ is economic output, usually measured as GDP, given in data.
* $\theta$ is a fitted scale parameter.
* $\lambda$ is the Solow residual.
* $t$ is time.
* $x_1$, $x_2$, and $x_3$ are factors of production.
* $\alpha_1$, $\alpha_2$, and $\alpha_3$ are output elasticities 
for the corresponding factors of production
in the Cobb-Douglas growth model.
* $\delta$ and $\delta_1$ are fitted share parameters for the CES growth model.
* $\rho$ and $\rho_1$ are fitted parameters related the elasticity of substitution. (See below.)
* $a_0$ and $a_1$ are fitted coefficients in the Linex production function.


Also, 
$\sigma$ and $\sigma_1$ are elasticities of substitution for the CES growth model,
given by
$\sigma = \frac{1}{1 + \rho}$ and $\sigma_1 = \frac{1}{1 + \rho_1}$.
$c_t$ is the ratio of Linex coefficients,
given by 
$c_t = \frac{a_1}{a_0}$.



### Fitting examples

To fit a model to macroeconomic data, use one of the `*Model` functions.
For example, to fit the Cobb-Douglas model to the UK's capital stock and labor data,
use the `cdModel` function.

```{r}
cdfit <- cdModel(formula = iGDP ~ iK + iL + iYear, data = EconUK)
cdfit
```
The `formula` argument provides a convenient way to specify which variables in the data frame
occupy which positions of the model.
The components of the formula are: 

* the "response" variable (usually indexed GDP), positioned to the left of the `~` character,
* indexed factors of production, separated by "+" and positioned to the right of the `~` character,
and  
* the time variable, indexed to 0 at the top of the data frame,
separated from the factors of production by a `+` character, and 
positioned as the rightmost item in the formula. 

In the above example, `iGDP ~ iK + iL + iYear` indicates that
the model is to be fitted with 
indexed GDP (iGDP) as the response variable,
indexed capital stock (iK) and indexed labor (iL) as the factors of production, and
indexed year (iYear) as the time variable.

The coefficients of the model can be recovered with the `naturalCoef` function.

```{r}
naturalCoef(cdfit)
```

Similar function can be used for the other model types.

For the CES production function, use the `cesModel` function.

```{r}
cesfit <- cesModel(formula = iGDP ~ iK + iL + iYear, data = EconUK)
naturalCoef(cesfit)
```


For the Linex model, 
there must be three factors of production, and 
the third factor of production must be the energy variable,
as indexed useful exergy (`iXp`) in the example below.

```{r}
linexfit <- linexModel(formula = iGDP ~ iK + iL + iXp + iYear, data = EconUK)
naturalCoef(linexfit)
```

### Accounting for boundaries


## Resampling

## Plotting results

## References

* cesEst/Henningsen and Henningsen
* Cautionary tales paper



