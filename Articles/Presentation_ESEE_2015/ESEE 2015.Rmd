---
title: "Effect of quality-adjusted production function inputs"
author: "Paul Brockway, Jo√£o dos Santos, Matthew Kuperus Heun"
date: "10 April 2015"
output: pdf_document
---

```{r Setup, message=FALSE, warning=FALSE, echo=FALSE}
require(EconData)
require(EconModels)
require(dplyr)

#####################################################
evalCES=FALSE
#####################################################
```

This is a study of the effects of quality-adjusted production function inputs
on the importance of energy in the production function.

# Historical Data

Historical data are stored in the `IST` and `Leeds` data sets.

```{r Data}
dataPT <- filter(IST, Country == "PT")
dataUK <- filter(Leeds, Country == "UK")
```

## Unadjusted variables

For unadjusted variables, we use the following time series:

Variable | PT       | UK    
-------- | -------- | -----------
Output   | iGDP     | iGDP
Capital  | iKstkS.L | iKstkO.WwithRD
Labor    | iL       | iL
Energy   | iXpMP    | iXp

## Quality-adjusted variables

For quality-adjusted variables, we use the following time series:

Variable | PT         | UK    
-------- | ---------- | ---------------
Output   | iGDP       | iGDP
Capital  | iKservS.L  | iKservO.WwithRD
Labor    | ihLest     | ihLest
Energy   | iUMP       | iU

# Fitting

Fitting is accomplished with `formula`s of the form

$$
y \sim x_1 + x_2 + x_3 + time,
$$

where $y$ is economic output (measured by GDP) and 
$x_1$, $x_2$, and $x_3$ are factors of production
and permutations of
capital ($k$), labor ($l$), and energy ($e$).
(The factors of production may be quality-adjusted.)
$time$ is the time variable, usually \texttt{iYear}. 

# Models

The Cobb-Douglas model is given as

$$
  y = \theta \: A \: x_1^{\alpha_1} \: x_2^{\alpha_2} \: x_3^{\alpha_3}; 
      A = \mathrm{e}^{\lambda (t-t_0)}.
$$

Note that 
`scale`  $= \theta$, 
$\alpha_1 = \alpha$,
$\alpha_2 = \beta$, and
$\alpha_3 = \gamma$,
when the `formula` is specified as \texttt{y~$\sim$~k~+~l~+~e~+~time}.
$\theta$ is expected to be near unity.

The CES model is given as

$$
  y = \gamma \: A \: \left\{\delta \left[\delta_1 x_1^{-\rho_1} 
      + (1-\delta_1)x_2^{-\rho_1} \right]^{\rho/\rho_1} 
      + (1-\delta) x_3^{-\rho} \right\}^{-1/\rho}; 
      A = \mathrm{e}^{\lambda (t-t_0)}.
$$

Note that `scale` $= \gamma$ and is expected to be close to unity. 
Equations for $\alpha_1$, $\alpha_2$, and $\alpha_3$ are given in Table \ref{tab:CES_abg_equations}.

\begin{table} \caption{Equations for $\alpha$, $\beta$, and $\gamma$ for the various CES nestings, 
                        provided that the \texttt{formula} is specified as \texttt{y~$\sim$~k~+~l~+~e~+~time}.} 
\label{tab:CES_abg_equations} 
  \begin{center}
    \begin{tabular}{c c c c c} 
      \toprule
      Nesting         & Nest              & $\alpha_1$ ($\alpha$)   & $\alpha_2$ ($\beta$)    & $\alpha_3$ ($\gamma$)       \\
      \midrule
      ($kl$) + ()     & \texttt{c(1,2)}   & $\delta_1$              & $1 - \delta_1$          & 0          \\
      ($kl$) + ($e$)  & \texttt{c(1,2,3)} & $\delta \delta_1$       & $\delta (1 - \delta_1)$ & $1 - \delta$ \\   
      ($le$) + ($k$)  & \texttt{c(2,3,1)} & $1 - \delta$            & $\delta \delta_1$       & $\delta (1 - \delta_1)$ \\
      ($ek$) + ($l$)  & \texttt{c(3,1,2)} & $\delta (1 - \delta_1)$ & $1 - \delta$            & $\delta \delta_1$ \\
      \bottomrule
    \end{tabular}
  \end{center}
\end{table}

# Questions

For now, I've organized the analysis by questions that we would like to answer.

## What effect does including energy and quality-adjustment have on the Solow residual in the Cobb-Douglas model?

We'll first look at Portugal.

### Portugal

First, use non-quality-adjusted data for Portugal and the Cobb-Douglas model.

```{r reduce Solow residual PT unadjusted}
ptCDunadjNoE <- cdModel(formula = iGDP ~ iKstkS.L + iL + iYear, 
                        data = dataPT, constrained = TRUE)
ptCDunadjWithE <- cdModel(formula = iGDP ~ iKstkS.L + iL + iXpMP + iYear, 
                          data = dataPT, constrained = TRUE)
naturalCoef(ptCDunadjNoE)
naturalCoef(ptCDunadjWithE)
```

The Solow residual (`lambda`) decreased from 
`r naturalCoef(ptCDunadjNoE)$lambda` to 
`r naturalCoef(ptCDunadjWithE)$lambda`,
so it appears that for Portugal, 
using unadjusted inputs and including energy as a factor of production
reduces the Solow residual significantly.

What about for quality-adjusted data and Portugal?

``` {r reduce Solow residual PT adjusted}
ptCDadjNoE <- cdModel(formula = iGDP ~ iKservS.L + ihLest + iYear, 
                        data = dataPT, constrained = TRUE)
ptCDadjWithE <- cdModel(formula = iGDP ~ iKservS.L + ihLest + iUMP + iYear, 
                          data = dataPT, constrained = TRUE)
naturalCoef(ptCDadjNoE)
naturalCoef(ptCDadjWithE)
```

Using quality-adjusted inputs, the Solow residual (`lambda`) moves from 
`r naturalCoef(ptCDadjNoE)$lambda` to
`r naturalCoef(ptCDadjWithE)$lambda`.

When we look at the effect of both quality-corrected factors of production and energy,
we see that both including energy and quality-adjusting the factors of production 
reduce the Solow residual (`lambda`). 
Quality-adjustment gets part of the way toward eliminating the Solow residual.
Including energy (whether or not the factors of production are quality-adjusted)
reduces the Solow residual significantly.

Energy/Adjusted | Unadjusted                             | Quality-adjusted
--------------- | -------------------------------------- | -----------------------------------
Without energy  | `r naturalCoef(ptCDunadjNoE)$lambda`   | `r naturalCoef(ptCDadjNoE)$lambda`
With energy     | `r naturalCoef(ptCDunadjWithE)$lambda` | `r naturalCoef(ptCDadjWithE)$lambda`

Note that the contribution of capital (`alpha_1`)
always decreases when energy (`alpha_3`) is included as a factor of production.

What about for the UK?

### United Kingdom

```{r reduce Solow residual UK}
ukCDunadjNoE <- cdModel(formula = iGDP ~ iKstkO.WwithRD + iL + iYear, 
                        data = dataUK, constrained = TRUE)
ukCDunadjWithE <- cdModel(formula = iGDP ~ iKstkO.WwithRD + iL + iXp + iYear, 
                          data = dataUK, constrained = TRUE)
ukCDadjNoE <- cdModel(formula = iGDP ~ iKservO.WwithRD + ihLest + iYear, 
                        data = dataUK, constrained = TRUE)
ukCDadjWithE <- cdModel(formula = iGDP ~ iKservO.WwithRD + ihLest + iU + iYear, 
                          data = dataUK, constrained = TRUE)
```

Energy/Adjusted | Unadjusted                             | Quality-adjusted
--------------- | -------------------------------------- | -----------------------------------
Without energy  | `r naturalCoef(ukCDunadjNoE)$lambda`   | `r naturalCoef(ukCDadjNoE)$lambda`
With energy     | `r naturalCoef(ukCDunadjWithE)$lambda` | `r naturalCoef(ukCDadjWithE)$lambda`

For the UK, the quality-adjusted, with energy Solow residual is 
`r naturalCoef(ukCDadjWithE)$lambda * 100`%,
a very small number indeed.
For the UK, it appears that both quality-adjustment and addition of energy as a factor of production
can effectively eliminate the Solow residual,
reducing it to `r naturalCoef(ukCDadjWithE)$lambda`.

Interestingly, the Solow residual acutally increases from 
`r naturalCoef(ukCDunadjNoE)$lambda` to
`r naturalCoef(ukCDunadjWithE)$lambda`
for unadjusted factors of production when energy is added.
To find out why, let's look at all the coefficients.

``` {r}
naturalCoef(ukCDunadjNoE)
naturalCoef(ukCDunadjWithE)
```

When energy is included, much of the effect of capital (`alpha_1`) is 
attributed to energy (`alpha_3`), 
as `alpha_1` moves from 
`r naturalCoef(ukCDunadjNoE)$alpha_1` to
`r naturalCoef(ukCDunadjWithE)$alpha_1`.

When we look at quality-adjusted inputs, we find similar results.

``` {r}
naturalCoef(ukCDadjNoE)
naturalCoef(ukCDadjWithE)
```

`alpha_1` moves from 
`r naturalCoef(ukCDadjNoE)$alpha_1` to
`r naturalCoef(ukCDadjWithE)$alpha_1`.





# CES results

## Unadjusted inputs

```{r CES unadjusted, warning=FALSE, eval=evalCES}
naturalCoef(cesModel(formula = iGDP ~ iKstkS.L + iL + iXpMP + iYear, 
                     nest = c(1,2,3), data = dataPT, constrained = TRUE))
naturalCoef(cesModel(formula = iGDP ~ iKstkO.WwithRD + iL + iXp + iYear, 
                     nest = c(1,2,3), data = dataUK, constrained = TRUE))
```

## Quality-adjusted inputs

```{r CES quality adjusted, warning=FALSE, eval=evalCES}
naturalCoef(cesModel(formula = iGDP ~ iKservS.L + ihLest + iUMP + iYear, 
                    nest = c(1,2,3), data = dataPT, constrained = TRUE))
naturalCoef(cesModel(formula = iGDP ~ iKservO.WwithRD + ihLest + iU + iYear, 
                    nest = c(1,2,3), data = dataUK, constrained = TRUE))
```
