---
title: "Effect of quality-adjusted production function inputs"
author: "Paul Brockway, Jo√£o dos Santos, Matthew Kuperus Heun"
date: "10 April 2015"
output: pdf_document
---

```{r Setup, message=FALSE, warning=FALSE, echo=FALSE}
require(EconData)
require(EconModels)
require(dplyr)

#####################################################
evalCES=FALSE
#####################################################
```

This is a study of the effects of quality-adjusted production function inputs
on the importance of energy in the production function.

# Historical Data

Historical data are stored in the `IST` and `Leeds` data sets.

```{r Data}
dataPT <- filter(IST, Country == "PT")
dataUK <- filter(Leeds, Country == "UK")
```

## Unadjusted variables

For unadjusted variables, we use the following time series:

Variable | PT       | UK    
-------- | -------- | -----------
Output   | iGDP     | iGDP
Capital  | iKstkS.L | iKstkO.WwithRD
Labor    | iL       | iL
Energy   | iXpMP    | iXp

## Quality-adjusted variables

For quality-adjusted variables, we use the following time series:

Variable | PT         | UK    
-------- | ---------- | ---------------
Output   | iGDP       | iGDP
Capital  | iKservS.L  | iKservO.WwithRD
Labor    | ihLest     | ihLest
Energy   | iUMP       | iU

# Fitting

Fitting is accomplished with \emph{formulas} of the form

$$
y \sim x_1 + x_2 + x_3 + time,
$$

where $y$ is economic output (measured by GDP) and 
$x_1$, $x_2$, and $x_3$ are factors of production
and permutations of
capital ($k$), labor ($l$), and energy ($e$).
(The factors of production may be quality-adjusted.)
$time$ is the time variable, usually \texttt{iYear}. 

# Models

The Cobb-Douglas model is given as

$$
  y = \theta \: A \: x_1^{\alpha_1} \: x_2^{\alpha_2} \: x_3^{\alpha_3}; 
      A = \mathrm{e}^{\lambda (t-t_0)}.
$$

Note that 
`scale`  $= \theta$, 
$\alpha_1 = \alpha$,
$\alpha_2 = \beta$, and
$\alpha_3 = \gamma$,
when the `formula` is specified as \texttt{y~$\sim$~k~+~l~+~e~+~time}.
$\theta$ is expected to be near unity.

The CES model is given as

$$
  y = \gamma \: A \: \left\{\delta \left[\delta_1 x_1^{-\rho_1} 
      + (1-\delta_1)x_2^{-\rho_1} \right]^{\rho/\rho_1} 
      + (1-\delta) x_3^{-\rho} \right\}^{-1/\rho}; 
      A = \mathrm{e}^{\lambda (t-t_0)}.
$$

Note that `scale` $= \gamma$ and is expected to be close to unity. 
Equations for $\alpha_1$, $\alpha_2$, and $\alpha_3$ are given in Table \ref{tab:CES_abg_equations}.

\begin{table} \caption{Equations for $\alpha$, $\beta$, and $\gamma$ for the various CES nestings, 
                        provided that the \texttt{formula} is specified as \texttt{y~$\sim$~k~+~l~+~e~+~time}.} 
\label{tab:CES_abg_equations} 
  \begin{center}
    \begin{tabular}{c c c c c} 
      \toprule
      Nesting         & Nest              & $\alpha_1$ ($\alpha$)   & $\alpha_2$ ($\beta$)    & $\alpha_3$ ($\gamma$)       \\
      \midrule
      ($kl$) + ()     & \texttt{c(1,2)}   & $\delta_1$              & $1 - \delta_1$          & 0          \\
      ($kl$) + ($e$)  & \texttt{c(1,2,3)} & $\delta \delta_1$       & $\delta (1 - \delta_1)$ & $1 - \delta$ \\   
      ($le$) + ($k$)  & \texttt{c(2,3,1)} & $1 - \delta$            & $\delta \delta_1$       & $\delta (1 - \delta_1)$ \\
      ($ek$) + ($l$)  & \texttt{c(3,1,2)} & $\delta (1 - \delta_1)$ & $1 - \delta$            & $\delta \delta_1$ \\
      \bottomrule
    \end{tabular}
  \end{center}
\end{table}

# Questions

List of questions here.
Then, answer the questions with the results.

# Cobb-Douglas results


## Unadjusted inputs

```{r CD unadjusted}
naturalCoef(cdModel(formula = iGDP ~ iKstkS.L + iL + iXpMP + iYear, 
                    data = dataPT, constrained = TRUE))
naturalCoef(cdModel(formula = iGDP ~ iKstkO.WwithRD + iL + iXp + iYear, 
                    data = dataUK, constrained = TRUE))
```

## Quality-adjusted inputs

```{r CD quality adjusted}
naturalCoef(cdModel(formula = iGDP ~ iKservS.L + ihLest + iUMP + iYear, 
                    data = dataPT, constrained = TRUE))
naturalCoef(cdModel(formula = iGDP ~ iKservO.WwithRD + ihLest + iU + iYear, 
                    data = dataUK, constrained = TRUE))
```


# CES results

## Unadjusted inputs

```{r CES unadjusted, warning=FALSE, eval=evalCES}
naturalCoef(cesModel(formula = iGDP ~ iKstkS.L + iL + iXpMP + iYear, 
                     nest = c(1,2,3), data = dataPT, constrained = TRUE))
naturalCoef(cesModel(formula = iGDP ~ iKstkO.WwithRD + iL + iXp + iYear, 
                     nest = c(1,2,3), data = dataUK, constrained = TRUE))
```

## Quality-adjusted inputs

```{r CES quality adjusted, warning=FALSE, eval=evalCES}
naturalCoef(cesModel(formula = iGDP ~ iKservS.L + ihLest + iUMP + iYear, 
                    nest = c(1,2,3), data = dataPT, constrained = TRUE))
naturalCoef(cesModel(formula = iGDP ~ iKservO.WwithRD + ihLest + iU + iYear, 
                    nest = c(1,2,3), data = dataUK, constrained = TRUE))
```
