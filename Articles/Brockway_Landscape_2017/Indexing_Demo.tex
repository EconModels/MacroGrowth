\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}

\title{Demonstration of Effect of Indexing on\\
Cobb-Douglas and CES\\
Aggregate Production Functions}
\author{Matthew Kuperus Heun}
\maketitle



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Models} 
\label{sec:models}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

For demonstration purposes, 
we focus on models that assume capital and labor factors of production only.


%++++++++++++++++++++++++++++++
\subsection{Raw historical data} 
\label{sec:raw}
%++++++++++++++++++++++++++++++

The Cobb-Douglas model for using raw historical data is given by 
%
\begin{equation} \label{eq:CD_model_nonindexed}
  Y = \theta \: \mathrm{e}^{\lambda t} \: K^{\alpha_k} \, L^{\alpha_l} \; ,
\end{equation}
%
where $Y$, $K$, and $L$ are the raw (non-indexed) time series.
Time ($t$) is indexed by difference to the intial year (1960).

The CES model with raw historical data is given by
%
\begin{equation} \label{eq:CESkl_nonindexed}
  Y = \gamma \: \mathrm{e}^{\lambda t} \left[\delta K^{-\rho}
      + (1-\delta)L^{-\rho} \right]^{-1/\rho} \; .
\end{equation}


%++++++++++++++++++++++++++++++
\subsection{Indexed factors of production} 
\label{sec:indexed}
%++++++++++++++++++++++++++++++

The Cobb-Douglas model indexed historical data is given by
%
\begin{equation} \label{eq:CD_model}
  y = \theta \: \mathrm{e}^{\lambda t} \: k^{\alpha_k} \, l^{\alpha_l} \; ,
\end{equation}
%
where $y$, $k$, and $l$ are indexed by ratio to the initial year (1960). 
For example,
%
\begin{equation} \label{eq:indexing}
  y = Y/Y_{1960} \; .
\end{equation}

The CES model with indexed historical data is given by 
%
\begin{equation} \label{eq:CESkl}
  y = \gamma \: \mathrm{e}^{\lambda t} \left[\delta k^{-\rho}
      + (1-\delta)l^{-\rho} \right]^{-1/\rho} \; .
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Data} 
\label{sec:data}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

All data are from the Penn World Table.
Figure~\ref{fig:GDP-graph} below shows historical data as dots.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{UKdata} \hlkwb{<-} \hlkwd{read.csv}\hlstd{(}\hlkwd{file.path}\hlstd{(}\hlstr{"data"}\hlstd{,} \hlstr{"IndexingDemoRawData.csv"}\hlstd{))}
\end{alltt}
\end{kframe}
\end{knitrout}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Fitting} 
\label{sec:fitting}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Next, we fit both the Cobb-Douglas and CES aggregate production functions 
to both indexed and non-indexed data.
Figure~\ref{fig:GDP-graph} below shows historical data as lines.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{cd_nonindexed} \hlkwb{<-} \hlkwd{cdModel}\hlstd{(GDP} \hlopt{~} \hlstd{K} \hlopt{+} \hlstd{L} \hlopt{+} \hlstd{iYear,} \hlkwc{data} \hlstd{= UKdata)}
\hlstd{cd_indexed} \hlkwb{<-} \hlkwd{cdModel}\hlstd{(iGDP} \hlopt{~} \hlstd{iK} \hlopt{+} \hlstd{iL} \hlopt{+} \hlstd{iYear,} \hlkwc{data} \hlstd{= UKdata)}
\hlstd{ces_nonindexed} \hlkwb{<-} \hlkwd{cesModel}\hlstd{(GDP} \hlopt{~} \hlstd{K} \hlopt{+} \hlstd{L} \hlopt{+} \hlstd{iYear,} \hlkwc{data} \hlstd{= UKdata)}
\hlstd{ces_indexed} \hlkwb{<-} \hlkwd{cesModel}\hlstd{(iGDP} \hlopt{~} \hlstd{iK} \hlopt{+} \hlstd{iL} \hlopt{+} \hlstd{iYear,} \hlkwc{data} \hlstd{= UKdata)}
\end{alltt}
\end{kframe}
\end{knitrout}



We graph each type of fitted model against historical data.
Note that all models provide excellent fits.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{ggplot}\hlstd{(}\hlkwc{data} \hlstd{= quadplotdata,} \hlkwc{mapping} \hlstd{=} \hlkwd{aes_string}\hlstd{(}\hlkwc{x} \hlstd{=} \hlstr{"Year"}\hlstd{))} \hlopt{+}
  \hlkwd{geom_point}\hlstd{(}\hlkwc{mapping} \hlstd{=} \hlkwd{aes_string}\hlstd{(}\hlkwc{y} \hlstd{=} \hlstr{"y_historical"}\hlstd{),}
             \hlkwc{size} \hlstd{=} \hlnum{0.2}\hlstd{)} \hlopt{+}
  \hlkwd{geom_line}\hlstd{(}\hlkwc{mapping} \hlstd{=} \hlkwd{aes_string}\hlstd{(}\hlkwc{y} \hlstd{=} \hlstr{"y_hat"}\hlstd{))} \hlopt{+}
  \hlkwd{facet_grid}\hlstd{(indexed} \hlopt{~} \hlstd{apf,} \hlkwc{scales} \hlstd{=} \hlstr{"free"}\hlstd{)} \hlopt{+}
  \hlkwd{xlab}\hlstd{(}\hlkwa{NULL}\hlstd{)} \hlopt{+}
  \hlkwd{ylab}\hlstd{(}\hlstr{"GDP [raw: millions 2005$, indexed: 1960 = 1]"}\hlstd{)} \hlopt{+}
  \hlkwd{xy_theme}\hlstd{()}
\end{alltt}
\end{kframe}\begin{figure}

{\centering \includegraphics[width=\maxwidth]{figure/GDP-graph-1} 

}

\caption[Fits to historical data]{Fits to historical data. Dots are historical data. Lines are fits.}\label{fig:GDP-graph}
\end{figure}


\end{knitrout}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Coefficients} 
\label{sec:coefficients}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%++++++++++++++++++++++++++++++
\subsection{Cobb-Douglas} 
\label{sec:cd_coeffs}
%++++++++++++++++++++++++++++++

Here are the coefficients for the Cobb-Douglas models.
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{cd_nonindexed}
\end{alltt}
\begin{verbatim}
## Generalized least squares fit by REML
##   Model: log(GDP) - log(L) ~ I(log(K) - log(L)) + iYear 
##   Data: sdata 
##   Log-restricted-likelihood: 107.8529
## 
## Coefficients:
##    logscale     alpha_1      lambda 
## -5.37466764  0.56178381  0.01019556 
## 
## Degrees of freedom: 52 total; 49 residual
## Residual standard error: 0.02369495
\end{verbatim}
\begin{alltt}
\hlstd{cd_indexed}
\end{alltt}
\begin{verbatim}
## Generalized least squares fit by REML
##   Model: log(iGDP) - log(iL) ~ I(log(iK) - log(iL)) + iYear 
##   Data: sdata 
##   Log-restricted-likelihood: 107.8529
## 
## Coefficients:
##     logscale      alpha_1       lambda 
## -0.002331844  0.561783810  0.010195560 
## 
## Degrees of freedom: 52 total; 49 residual
## Residual standard error: 0.02369495
\end{verbatim}
\end{kframe}
\end{knitrout}

Note that the fitted parameters 
output elasticity
\verb+alpha_1+ ($\alpha_k$) 
and 
Solow residual growth rate
\verb+lambda+
are identical,
regardless of whether the historical data are indexed or not.

The pre-multiplier (in this case \texttt{logscale})
accounts for the fact that historical data have been indexed.
We can convert \texttt{logscale} to $\theta$ as follows:

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{exp}\hlstd{(cd_nonindexed}\hlopt{$}\hlstd{coefficients[[}\hlstr{"logscale"}\hlstd{]])}
\end{alltt}
\begin{verbatim}
## [1] 0.004632458
\end{verbatim}
\begin{alltt}
\hlkwd{exp}\hlstd{(cd_indexed}\hlopt{$}\hlstd{coefficients[[}\hlstr{"logscale"}\hlstd{]])}
\end{alltt}
\begin{verbatim}
## [1] 0.9976709
\end{verbatim}
\end{kframe}
\end{knitrout}

Note that $\theta$ for the indexed model is near 1.0, as expected.


%++++++++++++++++++++++++++++++
\subsection{CES}
\label{sec:ces_coeffs}
%++++++++++++++++++++++++++++++

The following shows parameters for CES models
fitted to non-indexed and indexed historical data.

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{ces_nonindexed}
\end{alltt}
\begin{verbatim}
## Estimated CES function
## 
## Call:
## cesEst(yName = "GDP", xNames = c("K", "L"), data = data, tName = "iYear", 
##     method = "PORT", start = c(0.0078125108214483, 0.00583042323510128, 
##     0.484469079677766, 0.1), lower = NULL, upper = NULL, multErr = TRUE, 
##     control = list(iter.max = 2000, eval.max = 2000))
## 
## Coefficients:
##     gamma    lambda     delta       rho 
## 2.047e-05 1.784e-02 2.855e-06 1.200e+00 
## 
## Elasticity of Substitution: 0.4546
\end{verbatim}
\begin{alltt}
\hlstd{ces_indexed}
\end{alltt}
\begin{verbatim}
## Estimated CES function
## 
## Call:
## cesEst(yName = "iGDP", xNames = c("iK", "iL"), data = data, tName = "iYear", 
##     method = "PORT", start = c(0.980366854292426, 0.0169427187219337, 
##     0.509982506947314, 1), lower = NULL, upper = NULL, multErr = TRUE, 
##     control = list(iter.max = 2000, eval.max = 2000))
## 
## Coefficients:
##   gamma  lambda   delta     rho 
## 0.97753 0.01784 0.50893 1.19979 
## 
## Elasticity of Substitution: 0.4546
\end{verbatim}
\end{kframe}
\end{knitrout}

As expected, and similar to the Cobb-Douglas model,
the growth rate of the Solow residual
(\verb+gamma+)
is identical, regardless of whether the historical data are indexed or not.
Again, similar to the Cobb-Douglas model, 
the pre-multiplier term
(in this case \verb+gamma+)
is different depending upon whether the historical data were indexed or not.
We note that the value of \verb+gamma+ is close to 1,
when fitting to indexed data,
as expected.
Furthermore, the elasticity of substitution parameters
(\verb+rho+)
are identical regardless of whether the historical data are indexed or not.

However, the share parameter
(\verb+delta+)
varies significantly, depending upon whether 
the historical data are indexed.
Any inferences about the economy that depend upon the share parameter (\verb+delta+)
will be significantly different depending upon whether the 
historical data are indexed prior to fitting.

\end{document}
