---
title: "Estimating precision of estimated parameters in CES models"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(mosaic)
require(EconModels)
```

			
I was reading the help page to see what I could figure out about
just what `cesEst()` is doing to compute standard errors.  (That’s 
still not entirely clear to me, but I think it is making use of the 
derivatives of the objective function — the flatter the objective 
function the larger the standard error.)  But I don’t exactly 
understand the details yet.  I know what the scaled and unscaled 
covariance matrices are for a linear model (and cesEst() computes 
the scaled vcov matrix only when it is using a linear model, which 
it can do by fitting a linearised version of the actual 
CES function, but that’s not what we are doing.

Anyway, I’m trying to figure out what to make of this:

```{r}
usdata <- 
  read.csv("../Articles/Brockway_Rebound_2015/data/BrockwayData.csv") %>% filter(Country == "US")
mod <- 
  cesModel(iY ~ iK + iL + iU + iYear, data=usdata, nest=c(1,2,3))
```

## Computation of standard errors

### Degrees of freedom = n

Looks like there is no attempt to adjust degrees of freedom based on the 
number of parameters in the model:

```{r}
smod <- summary(mod)
mod$rss / nrow(usdata)
smod$sigma^2
```

```{r}
diag(mod$cov.unscaled) * smod$sigma^2 
diag(smod$vcov)
```

## Convergence observation
```{r}
mod$nlminb
```