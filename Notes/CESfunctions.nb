(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12017,        394]
NotebookOptionsPosition[     11231,        362]
NotebookOutlinePosition[     11586,        378]
CellTagsIndexPosition[     11543,        375]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"nest1", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["delta", "1"], " ", "*", " ", 
      RowBox[{"k", "^", 
       RowBox[{"(", 
        RowBox[{"-", 
         SubscriptBox["rho", "1"]}], ")"}]}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", " ", "-", " ", 
        SubscriptBox["delta", "1"]}], ")"}], " ", "*", " ", 
      RowBox[{"l", "^", 
       RowBox[{"(", 
        RowBox[{"-", 
         SubscriptBox["rho", "1"]}], ")"}]}]}]}], ")"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{"CES", " ", "=", " ", 
  RowBox[{"theta", " ", "*", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{"lambda", " ", "*", " ", "t"}], "]"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"delta", " ", "*", " ", 
       RowBox[{"nest1", " ", "^", " ", 
        RowBox[{"(", 
         RowBox[{"rho", "/", 
          SubscriptBox["rho", "1"]}], ")"}]}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", "*", " ", 
       RowBox[{"e", "^", 
        RowBox[{"(", 
         RowBox[{"-", "rho"}], ")"}]}]}]}], " ", ")"}], "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "rho"}], 
     ")"}]}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.651220942545884*^9, 3.6512210175972357`*^9}, {
  3.651221642728677*^9, 3.651221796491006*^9}, {3.651221880983873*^9, 
  3.651221909862471*^9}, {3.651221951621029*^9, 3.651221994828431*^9}, {
  3.6512226429581537`*^9, 3.6512226611881647`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["l", 
    RowBox[{"-", 
     SubscriptBox["rho", "1"]}]], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SubscriptBox["delta", "1"]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["k", 
    RowBox[{"-", 
     SubscriptBox["rho", "1"]}]], " ", 
   SubscriptBox["delta", "1"]}]}]], "Output",
 CellChangeTimes->{
  3.651221809493512*^9, {3.651221896924995*^9, 3.651221918884611*^9}, 
   3.6512219961739683`*^9, 3.651222663023323*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"lambda", " ", "t"}]], " ", "theta", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "delta"}], ")"}], " ", 
      SuperscriptBox["e", 
       RowBox[{"-", "rho"}]]}], "+", 
     RowBox[{"delta", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["l", 
           RowBox[{"-", 
            SubscriptBox["rho", "1"]}]], " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SubscriptBox["delta", "1"]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["k", 
           RowBox[{"-", 
            SubscriptBox["rho", "1"]}]], " ", 
          SubscriptBox["delta", "1"]}]}], ")"}], 
       FractionBox["rho", 
        SubscriptBox["rho", "1"]]]}]}], ")"}], 
   RowBox[{
    RowBox[{"-", "1"}], "/", "rho"}]]}]], "Output",
 CellChangeTimes->{
  3.651221809493512*^9, {3.651221896924995*^9, 3.651221918884611*^9}, 
   3.6512219961739683`*^9, 3.6512226630329*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"oek", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"CES", ",", " ", "k"}], "]"}], " ", "*", " ", 
   RowBox[{"k", "/", "c"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"oel", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"CES", ",", " ", "l"}], "]"}], " ", "*", " ", 
   RowBox[{"l", "/", "c"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"oee", " ", "=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"CES", ",", " ", "e"}], "]"}], " ", "*", " ", 
   RowBox[{"e", "/", "c"}]}]}]}], "Input",
 CellChangeTimes->{{3.651222050365787*^9, 3.651222078307117*^9}, {
  3.6512221337262497`*^9, 3.6512222095124283`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "c"], 
  RowBox[{"delta", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"lambda", " ", "t"}]], " ", 
   SuperscriptBox["k", 
    RowBox[{"-", 
     SubscriptBox["rho", "1"]}]], " ", "theta", " ", 
   SubscriptBox["delta", "1"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["l", 
        RowBox[{"-", 
         SubscriptBox["rho", "1"]}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["delta", "1"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["k", 
        RowBox[{"-", 
         SubscriptBox["rho", "1"]}]], " ", 
       SubscriptBox["delta", "1"]}]}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox["rho", 
      SubscriptBox["rho", "1"]]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", 
       SuperscriptBox["e", 
        RowBox[{"-", "rho"}]]}], "+", 
      RowBox[{"delta", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["l", 
            RowBox[{"-", 
             SubscriptBox["rho", "1"]}]], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SubscriptBox["delta", "1"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["k", 
            RowBox[{"-", 
             SubscriptBox["rho", "1"]}]], " ", 
           SubscriptBox["delta", "1"]}]}], ")"}], 
        FractionBox["rho", 
         SubscriptBox["rho", "1"]]]}]}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     FractionBox["1", "rho"]}]]}]}]], "Output",
 CellChangeTimes->{3.6512222129906063`*^9, 3.65122266567633*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "c"], 
  RowBox[{"delta", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"lambda", " ", "t"}]], " ", 
   SuperscriptBox["l", 
    RowBox[{"-", 
     SubscriptBox["rho", "1"]}]], " ", "theta", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SubscriptBox["delta", "1"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["l", 
        RowBox[{"-", 
         SubscriptBox["rho", "1"]}]], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["delta", "1"]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["k", 
        RowBox[{"-", 
         SubscriptBox["rho", "1"]}]], " ", 
       SubscriptBox["delta", "1"]}]}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     FractionBox["rho", 
      SubscriptBox["rho", "1"]]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", 
       SuperscriptBox["e", 
        RowBox[{"-", "rho"}]]}], "+", 
      RowBox[{"delta", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["l", 
            RowBox[{"-", 
             SubscriptBox["rho", "1"]}]], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SubscriptBox["delta", "1"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["k", 
            RowBox[{"-", 
             SubscriptBox["rho", "1"]}]], " ", 
           SubscriptBox["delta", "1"]}]}], ")"}], 
        FractionBox["rho", 
         SubscriptBox["rho", "1"]]]}]}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     FractionBox["1", "rho"]}]]}]}]], "Output",
 CellChangeTimes->{3.6512222129906063`*^9, 3.651222665687954*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "c"], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "delta"}], ")"}], " ", 
   SuperscriptBox["e", 
    RowBox[{"-", "rho"}]], " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"lambda", " ", "t"}]], " ", "theta", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "delta"}], ")"}], " ", 
       SuperscriptBox["e", 
        RowBox[{"-", "rho"}]]}], "+", 
      RowBox[{"delta", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["l", 
            RowBox[{"-", 
             SubscriptBox["rho", "1"]}]], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SubscriptBox["delta", "1"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["k", 
            RowBox[{"-", 
             SubscriptBox["rho", "1"]}]], " ", 
           SubscriptBox["delta", "1"]}]}], ")"}], 
        FractionBox["rho", 
         SubscriptBox["rho", "1"]]]}]}], ")"}], 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     FractionBox["1", "rho"]}]]}]}]], "Output",
 CellChangeTimes->{3.6512222129906063`*^9, 3.651222665694066*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "CES", "]"}]], "Input",
 CellChangeTimes->{{3.65122250821231*^9, 3.6512225113192253`*^9}}],

Cell["\<\
\\theta  e^{\\lambda  t} \\left((1-\\delta ) e^{-\\rho }+\\delta  \
\\left(\\delta _1 k^{-\\rho
   _1}+\\left(1-\\delta _1\\right) l^{-\\rho _1}\\right){}^{\\frac{\\rho \
}{\\rho
   _1}}\\right){}^{-1/\\rho }\
\>", "Output",
 CellChangeTimes->{3.651222512503924*^9, 3.6512226741482563`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", " ", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", "oek", "]"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{"Simplify", "[", "oel", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Simplify", "[", "oee", "]"}]}], "\[IndentingNewLine]", "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6512222193171787`*^9, 3.651222291129484*^9}}],

Cell["\<\
\\left\\{\\frac{\\delta  \\delta _1 k^{-\\rho _1} \\left(\\delta _1 k^{-\\rho \
_1}-\\left(\\delta
   _1-1\\right) l^{-\\rho _1}\\right){}^{\\frac{\\rho }{\\rho _1}-1} \
\\left(\\delta  \\left(\\delta
   _1 k^{-\\rho _1}-\\left(\\delta _1-1\\right) l^{-\\rho \
_1}\\right){}^{\\frac{\\rho }{\\rho
   _1}}-(\\delta -1) e^{-\\rho }\\right){}^{-\\frac{\\rho +1}{\\rho \
}}}{c},\\frac{\\delta 
   \\left(1-\\delta _1\\right) l^{-\\rho _1} \\left(\\delta _1 k^{-\\rho _1}-\
\\left(\\delta
   _1-1\\right) l^{-\\rho _1}\\right){}^{\\frac{\\rho }{\\rho _1}-1} \
\\left(\\delta  \\left(\\delta
   _1 k^{-\\rho _1}-\\left(\\delta _1-1\\right) l^{-\\rho \
_1}\\right){}^{\\frac{\\rho }{\\rho
   _1}}-(\\delta -1) e^{-\\rho }\\right){}^{-\\frac{\\rho +1}{\\rho \
}}}{c},\\frac{(1-\\delta )
   e^{-\\rho } \\left(\\delta  \\left(\\delta _1 k^{-\\rho _1}-\\left(\\delta \
_1-1\\right)
   l^{-\\rho _1}\\right){}^{\\frac{\\rho }{\\rho _1}}-(\\delta -1) e^{-\\rho
   }\\right){}^{-\\frac{\\rho +1}{\\rho }}}{c}\\right\\}\
\>", "Output",
 CellChangeTimes->{3.651222234801766*^9, 3.651222292419528*^9}]
}, Open  ]]
},
WindowSize->{808, 700},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1556, 45, 80, "Input"],
Cell[2139, 69, 486, 16, 32, "Output"],
Cell[2628, 87, 1079, 34, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3744, 126, 660, 17, 63, "Input"],
Cell[4407, 145, 1760, 58, 104, "Output"],
Cell[6170, 205, 1812, 60, 104, "Output"],
Cell[7985, 267, 1219, 39, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9241, 311, 129, 2, 28, "Input"],
Cell[9373, 315, 300, 7, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9710, 327, 407, 8, 97, "Input"],
Cell[10120, 337, 1095, 22, 190, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
